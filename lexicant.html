<html>

<head>
</head>
<body>
    Lexicant game
    </br>
    <input autoFocus="true" maxLength=1 type="text" id="prepend">
    <textarea id="letters"></textarea>
    <input maxLength=1 type="text" id="append">
    <button id="button">Undo</button>
    <div style="background:green"></div>
</body>

<script src="LetterBitMapTrie.js"></script>

<script>
    let prepend = document.getElementById("prepend")
    let append = document.getElementById("append")
    let letters = document.getElementById("letters")
    let button = document.getElementById("button")

    let dictionary = []

    async function getDictionary() {
        response = await fetch("dictionary.json")
        dictionary = await response.json()
        return dictionary
    }

    getDictionary().then((value) => doMoreJavascript(value))

    function doMoreJavascript(dict) {
        dictionary = new Set(dict)
        console.log("dictionary")
        console.log(dictionary)
        trie = new LetterBitMapTrie(dictionary)
        console.log(trie)
        this.trie = trie
    }

    function prependLetter(event) {
      updateLetters("front", event.target.value)
      prepend.value = ""
    }

    function appendLetter(event) {
      updateLetters("end", event.target.value)
      append.value = ""
    }

    function undo() {
      updateLetters("pop")
    }

    function updateLetters(mode, char = null) {
      if (!letters.state) {
        letters.state = []
      }
      if (mode === "end") {
        letters.state.push([char, false]) 
        letters.innerHTML = letters.innerHTML + char
      } else if (mode === "front") {
        letters.state.push([char, true]) 
        letters.innerHTML = char + letters.innerHTML
      } else if (mode === "pop") {
        let arr = letters.state.pop()
        if (arr[1]) {
          letters.innerHTML = letters.innerHTML.substring(1)
        } else {
          letters.innerHTML = letters.innerHTML.substring(0, letters.innerHTML.length - 1)
        }
      }
    }

    prepend.oninput = prependLetter
    append.oninput = appendLetter
    button.onclick = undo
</script>
